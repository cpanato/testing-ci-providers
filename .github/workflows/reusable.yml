name: Reusable test

on:
  push:
  pull_request:

jobs:
  build-test-go:
    uses: cpanato/actions-reusable-test/.github/workflows/build-test-go.yml@main
    with:
      build_command: go build -o sample ./...
      test_command: go test ./...
      go_version: "1.17.7"

  test_cosign_action:
    runs-on: ubuntu-latest

    permissions:
      actions: none

    name: Install Cosign and test presence in path
    steps:
      - name: Install Cosign
        uses: sigstore/sigstore-installer@initial
        with:
          cosign-version: 'v1.5.2'
      - name: Check install!
        run: cosign version
      - name: Check install!
        run: rekor-cli version
